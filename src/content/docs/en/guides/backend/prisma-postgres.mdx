---
title: Prisma Postgres & Astro
description: Add a serverless Postgres database to your Astro project with Prisma Postgres
sidebar:
  label: Prisma Postgres
type: backend
service: Prisma Postgres
stub: false
i18nReady: true
---

import ReadMore from '~/components/ReadMore.astro';

[Prisma Postgres](https://www.prisma.io/) is a fully managed, serverless Postgres database built for modern web apps.

## Connect via Prisma ORM (Recommended)

[Prisma ORM](https://www.prisma.io/orm) is the recommended way to connect to your Prisma Postgres database. It provides type-safe queries, migrations, and global performance.

### Prerequisites
- An Astro project with an adapter installed to enable [on-demand rendering (SSR)](/en/guides/on-demand-rendering/).

### Install dependencies and initialize Prisma

Run the following commands to install the necessary Prisma dependencies:

```bash
npm install prisma tsx --save-dev
npm install @prisma/extension-accelerate @prisma/client
```

Once installed, initialize Prisma in your project with the following command:

```bash
npx prisma init --db --output ../src/generated/prisma
```

You'll need to answer a few questions while setting up your Prisma Postgres database. Select the region closest to your location and a memorable name for your database like "My Astro Project"

This will create:
- A `prisma/` directory with a `schema.prisma` file
- A `.env` file with a `DATABASE_URL` already set

### Define a Temporary Model in `schema.prisma`

Even if you don't need any specific data models yet, Prisma requires at least one model in the schema in order to generate a client and apply migrations.

In this example, we'll define a simple `Post` model as a placeholder. You can safely delete or replace it later with models that reflect your actual data.

```prisma title="prisma/schema.prisma" ins={11-16}
generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Post {
  id        Int     @id @default(autoincrement())
  title     String
  content   String?
  published Boolean @default(false)
}
```

> ðŸ’¡ Prisma needs at least one model defined to run `migrate` and generate the Prisma Client.  
> Learn more in the [Prisma schema reference](https://www.prisma.io/docs/concepts/components/prisma-schema).

### Run Prisma Migrate

Run the following command to create the database tables and generate the Prisma Client from your schema. This will also create a `prisma/migrations/` directory with the migration files.

```bash
npx prisma migrate dev --name init
```

### Create a Prisma Client

Inside of `/src/lib`, create a `prisma.ts` file. This file will initialize and export your Prisma Client instance so you can query your database throughout your Astro project.

```typescript title="src/lib/prisma.ts"
import { PrismaClient } from "../generated/prisma/client";
import { withAccelerate } from "@prisma/extension-accelerate";

const prisma = new PrismaClient({
  datasourceUrl: import.meta.env.DATABASE_URL,
}).$extends(withAccelerate());

export default prisma;
```

You can now query your database in your Astro project using the Prisma Client.

The following example shows how to use your Prisma Client in an Astro page to fetch and display data:

```typescript title="src/pages/posts.astro"
---
import prisma from '../lib/prisma';

// Fetch all published posts from the database
const posts = await prisma.post.findMany({
  where: { published: true },
  orderBy: { id: 'desc' }
});
---

<html>
  <head>
    <title>Published Posts</title>
  </head>
  <body>
    <h1>Published Posts</h1>
    <ul>
      {posts.map((post) => (
        <li>
          <h2>{post.title}</h2>
          {post.content && <p>{post.content}</p>}
        </li>
      ))}
    </ul>
  </body>
</html>
```

For more information on how to use Prisma Client in your Astro project, see the [Prisma Client API reference](https://www.prisma.io/docs/reference/api-reference/prisma-client-reference) and the [Astro + Prisma ORM Guide](https://www.prisma.io/docs/guides/astro).

## Connect via direct TCP connection

If you want to use your connection string directly, you can do so with the `pg` package.

### Prerequisites
- A [Prisma Postgres](https://pris.ly/ppg) database with a TCP enabled connection string
- An Astro project with [on-demand rendering (SSR)](/en/guides/on-demand-rendering/) enabled

### Install dependencies

Run the following command to install the `pg` package:

```bash
npm install pg
```

### Query your database client

Provide your connection string to the `pg` client to fetch data from your database. The following example shows how to connect to your database and query the current time:

```typescript title="src/pages/index.astro"
import { Client } from 'pg';

const client = new Client({ connectionString: import.meta.env.DATABASE_URL });
await client.connect();
const res = await client.query('SELECT NOW() as current_time');
const currentTime = res.rows[0].current_time;
await client.end();

---

<h1>Current Time</h1>
<p>The time is: {currentTime}</p>
```

## Official Resources

- [Astro + Prisma ORM Guide](https://www.prisma.io/docs/guides/astro)
